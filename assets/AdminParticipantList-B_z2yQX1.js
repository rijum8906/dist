import{r,j as a,L as B}from"./index-D8XRboE_.js";import{a as b,g as T,B as h,c as n,M as m,T as j,S as k,e as I}from"./url-CMfFpYZi.js";const A=()=>{const[d,p]=r.useState([]),[v,g]=r.useState([]),[s,S]=r.useState({house:"",name:"",event:"",category:""}),[N,w]=r.useState(0),[C,u]=r.useState(!1),[o,i]=r.useState(null);r.useEffect(()=>{b.get(T,{headers:{Authorization:`Bearer ${localStorage.getItem("token")}`}}).then(e=>{p(e.data.participants),g(e.data.participants)}).catch(e=>console.error("Error fetching participants:",e))},[]),r.useEffect(()=>{const e=d.filter(t=>(s.house===""||t.house===s.house)&&(s.event===""||t.event===s.event)&&(s.category===""||t.category===s.category)&&(s.name===""||t.name.toLowerCase().includes(s.name.toLowerCase())));g(e),P(e)},[s,d]);const x=e=>{const{name:t,value:c}=e.target;S(l=>({...l,[t]:c}))},P=e=>{let t=0;e.forEach(c=>{const l=parseInt(c.rank,10);l===1?t+=10:l===2?t+=7:l===3&&(t+=5)}),w(t)},E=()=>{localStorage.removeItem("token"),window.location.reload()},H=e=>{i(e),u(!0)},F=()=>{b.put(`${I}/${o._id}`,o,{headers:{Authorization:`Bearer ${localStorage.getItem("token")}`}}).then(e=>{const t=e.data.data.updatedParticipant;p(c=>c.map(l=>l._id===t._id?t:l)),g(c=>c.map(l=>l._id===t._id?t:l)),u(!1)}).catch(e=>console.error("Error updating participant:",e))},y=[...new Set(d.map(e=>e.house))],L=[...new Set(d.map(e=>e.event))],f=[...new Set(d.map(e=>e.category))];return a.jsxs("div",{children:[a.jsxs("div",{className:"flex space-x-4",children:[a.jsx(B,{to:"/add",children:a.jsx(h,{children:"Add Participant"})}),a.jsx(h,{onClick:E,children:"Log Out"})]}),a.jsxs("div",{className:"my-4",children:[a.jsx("strong",{children:"Total Points:"})," ",N]}),a.jsxs("div",{className:"flex flex-wrap gap-4 mb-4",children:[a.jsx("input",{type:"text",name:"name",placeholder:"Filter by Name",className:"p-2 border border-gray-300 rounded",value:s.name,onChange:x}),a.jsxs("select",{name:"house",className:"p-2 border border-gray-300 rounded",value:s.house,onChange:x,children:[a.jsx("option",{value:"",children:"Filter by House"}),y.map((e,t)=>a.jsx("option",{value:e,children:e},t))]}),a.jsxs("select",{name:"event",className:"p-2 border border-gray-300 rounded",value:s.event,onChange:x,children:[a.jsx("option",{value:"",children:"Filter by Event"}),L.map((e,t)=>a.jsx("option",{value:e,children:e},t))]}),a.jsxs("select",{name:"category",className:"p-2 border border-gray-300 rounded",value:s.category,onChange:x,children:[a.jsx("option",{value:"",children:"Filter by Category"}),f.map((e,t)=>a.jsx("option",{value:e,children:e},t))]})]}),a.jsx("div",{className:"overflow-x-auto",children:a.jsxs(n,{className:"min-w-full bg-white rounded shadow-md",children:[a.jsxs(n.Head,{className:"bg-gray-100",children:[a.jsx(n.HeadCell,{children:"Name"}),a.jsx(n.HeadCell,{children:"House"}),a.jsx(n.HeadCell,{children:"Category"}),a.jsx(n.HeadCell,{children:"Event"}),a.jsx(n.HeadCell,{children:"Rank"}),a.jsx(n.HeadCell,{children:"Actions"})]}),a.jsx(n.Body,{className:"divide-y",children:v.length>0?v.map((e,t)=>a.jsxs(n.Row,{className:"bg-white dark:border-gray-700 dark:bg-gray-800",children:[a.jsx(n.Cell,{children:e.name}),a.jsx(n.Cell,{children:e.house}),a.jsx(n.Cell,{children:e.category}),a.jsx(n.Cell,{children:e.event}),a.jsx(n.Cell,{children:e.rank}),a.jsx(n.Cell,{children:a.jsx(h,{onClick:()=>H(e),children:"Edit"})})]},t)):a.jsx(n.Row,{children:a.jsx(n.Cell,{colSpan:"6",className:"text-center py-4",children:"No participants found."})})})]})}),C&&a.jsxs(m,{show:C,onClose:()=>u(!1),children:[a.jsx(m.Header,{children:"Edit Participant"}),a.jsx(m.Body,{children:a.jsxs("div",{className:"flex flex-col gap-4",children:[a.jsx(j,{name:"name",placeholder:"Name",value:o.name,onChange:e=>i(t=>({...t,name:e.target.value}))}),a.jsxs(k,{name:"house",value:o.house,onChange:e=>i(t=>({...t,house:e.target.value})),children:[a.jsx("option",{value:"",children:"Select House"}),y.map((e,t)=>a.jsx("option",{value:e,children:e},t))]}),a.jsxs(k,{name:"category",value:o.category,onChange:e=>i(t=>({...t,category:e.target.value})),children:[a.jsx("option",{value:"",children:"Select Category"}),f.map((e,t)=>a.jsx("option",{value:e,children:e},t))]}),a.jsx(j,{name:"event",placeholder:"Event",value:o.event,onChange:e=>i(t=>({...t,event:e.target.value}))}),a.jsx(j,{name:"rank",placeholder:"Rank",type:"number",value:o.rank,onChange:e=>i(t=>({...t,rank:e.target.value}))})]})}),a.jsxs(m.Footer,{children:[a.jsx(h,{onClick:F,children:"Save Changes"}),a.jsx(h,{color:"gray",onClick:()=>u(!1),children:"Cancel"})]})]})]})};export{A as default};
